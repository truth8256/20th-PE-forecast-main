library(readxl)
library(dplyr)
library(tidyr)
library(purrr)
library(stringr)
library(readr)

setwd("D:\\OneDrive - ì—ìŠ¤í‹°ì•„ì´\\=ëŒ€í•™ì›\\=ë…¼ë¬¸ì—°êµ¬\\20th-PE-forecast-main\\0_data")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1ï¸âƒ£ ë°ì´í„° ì½ê¸° ë° long ë³€í™˜
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
read_unemp <- function(path, weeks_label) {
  # 1ï¸âƒ£ ë¨¸ë¦¬ê¸€(2í–‰) ì½ê¸°
  hdr <- read_excel(path, n_max = 2, col_names = FALSE)
  header1 <- as.character(unlist(hdr[1, ]))
  header2 <- as.character(unlist(hdr[2, ]))
  names_combined <- ifelse(is.na(header2), header1, paste(header1, header2))
  names_combined[1] <- "region"
  
  # 2ï¸âƒ£ ë³¸ë¬¸ ì½ê¸° (ëª¨ë“  ì—´ì„ ë¬¸ìë¡œ ê°•ì œ)
  df <- read_excel(path, skip = 2, col_names = FALSE, col_types = "text")
  colnames(df) <- names_combined
  
  # 3ï¸âƒ£ ê¸¸ê²Œ í¼ì¹˜ê¸°
  df_long <- df %>%
    pivot_longer(-region, names_to = "col", values_to = "value") %>%
    mutate(
      period = str_extract(col, "\\d{4}\\.[1-4]/4"),
      var = case_when(
        str_detect(col, "ê²½ì œí™œë™") ~ "labor_force",
        str_detect(col, "ì‹¤ì—…ì")   ~ "unemployed",
        str_detect(col, "ì‹¤ì—…ë¥ ")   ~ "ur",
        TRUE ~ NA_character_
      ),
      value = gsub(",", "", value),
      value = ifelse(value %in% c("", "-", "NA", "N/A"), NA, value),
      value = as.numeric(value),
      year  = as.integer(str_extract(period, "^\\d{4}")),
      qtr   = as.integer(str_extract(period, "(?<=\\.)[1-4]"))
    ) %>%
    filter(!is.na(var), !is.na(period))
  
  # 4ï¸âƒ£ ê° region-year-qtrë³„ë¡œ ì„¸ ë³€ìˆ˜ ê²°í•©
  df_wide <- df_long %>%
    group_by(region, year, qtr) %>%
    summarise(
      labor_force = value[var == "labor_force"][1],
      unemployed  = value[var == "unemployed"][1],
      ur          = value[var == "ur"][1],
      .groups = "drop"
    ) %>%
    mutate(
      week_basis = weeks_label
    )
  
  return(df_wide)
}



unemp_1w <- read_unemp("unemp_1w.xlsx", "1w")
unemp_4w <- read_unemp("unemp_4w.xlsx", "4w")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 2ï¸âƒ£ ë³‘í•© ì²˜ë¦¬ (ì„¸ì¢…â†”ì¶©ë‚¨ë§Œ í†µí•©, ìš¸ì‚°â†”ê²½ë‚¨ í†µí•© ì œê±°)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
combine_regions <- function(df) {
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 1ï¸âƒ£ ê¸°ë³¸ ì§€ì—­ ë§¤í•‘
  #    ğŸ”„ ìš¸ì‚°Â·ê²½ë‚¨ í†µí•©ì€ ì œê±°í•˜ê³ ,
  #       ì„¸ì¢…Â·ì¶©ë‚¨ í†µí•©ë§Œ ìœ ì§€
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  region_map <- c(
    "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ"  = "ì¶©ì²­ë‚¨ë„_í†µí•©",
    "ì¶©ì²­ë‚¨ë„"        = "ì¶©ì²­ë‚¨ë„_í†µí•©"
  )
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 2ï¸âƒ£ (ì‚­ì œë¨) ê²½ìƒë‚¨ë„_í†µí•©: í•­ìƒ í•©ì‚°
  #    ğŸ”„ ìš¸ì‚°/ê²½ë‚¨ì€ ë” ì´ìƒ í•©ì¹˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì´ ë¸”ë¡ ì „ì²´ ì œê±°
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # df_gyeongnam <- df %>%
  #   filter(region %in% c("ìš¸ì‚°ê´‘ì—­ì‹œ", "ê²½ìƒë‚¨ë„")) %>%
  #   mutate(region = "ê²½ìƒë‚¨ë„_í†µí•©") %>%
  #   group_by(region, year, qtr, week_basis) %>%
  #   summarise(
  #     labor_force = sum(labor_force, na.rm = TRUE),
  #     unemployed  = sum(unemployed, na.rm = TRUE),
  #     ur = 100 * unemployed / labor_force,
  #     .groups = "drop"
  #   )

  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 3ï¸âƒ£ ì¶©ì²­ë‚¨ë„_í†µí•©: ì¡°ê±´ë¶€ í•©ì‚°
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  df_chungnam <- df %>%
    filter(region %in% c("ì¶©ì²­ë‚¨ë„", "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ")) %>%
    group_by(year, qtr, week_basis) %>%
    summarise(
      n_exist = sum(!is.na(ur)),  # urì´ ì¡´ì¬í•˜ëŠ” ì§€ì—­ ìˆ˜
      labor_force_sum = sum(labor_force, na.rm = TRUE),
      unemployed_sum  = sum(unemployed, na.rm = TRUE),
      ur_chungnam = ur[region == "ì¶©ì²­ë‚¨ë„"][1],
      ur_sejong   = ur[region == "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ"][1],
      .groups = "drop"
    ) %>%
    mutate(
      region = "ì¶©ì²­ë‚¨ë„_í†µí•©",
      ur = case_when(
        n_exist == 2 ~ 100 * unemployed_sum / labor_force_sum,  # ë‘˜ ë‹¤ ì¡´ì¬ â†’ í•©ì‚°
        n_exist == 1 & !is.na(ur_chungnam) ~ ur_chungnam,       # ì¶©ë‚¨ë§Œ ì¡´ì¬ â†’ ê·¸ëŒ€ë¡œ
        n_exist == 1 & is.na(ur_chungnam) ~ ur_sejong,          # ì„¸ì¢…ë§Œ ì¡´ì¬ â†’ ê·¸ëŒ€ë¡œ
        TRUE ~ NA_real_
      ),
      labor_force = ifelse(n_exist == 2, labor_force_sum, NA),
      unemployed  = ifelse(n_exist == 2, unemployed_sum, NA)
    ) %>%
    select(region, year, qtr, week_basis, labor_force, unemployed, ur)
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 4ï¸âƒ£ ë‚˜ë¨¸ì§€ ì§€ì—­ ê·¸ëŒ€ë¡œ ìœ ì§€
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  df_keep <- df %>%
    filter(!region %in% names(region_map))
  
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  # 5ï¸âƒ£ ë³‘í•©
  # â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  df_final <- bind_rows(df_keep, df_chungnam) %>%
    arrange(region, year, qtr)
  
  return(df_final)
}



unemp_1w <- combine_regions(unemp_1w)
unemp_4w <- combine_regions(unemp_4w)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3ï¸âƒ£ 1ì£¼â†’4ì£¼ íšŒê·€ ë¸Œë¦¬ì§• (1999.3/4~2014.4/4 êµ¬ê°„ì—ì„œ ì¶”ì •)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# ê³µí†µ êµ¬ê°„ ì¶”ì¶œ
bridge_train <- unemp_1w %>%
  inner_join(unemp_4w, by = c("region", "year", "qtr"), suffix = c("_1w", "_4w")) %>%
  filter(!(year < 1999 | (year == 1999 & qtr < 3))) %>%
  filter(!(year > 2014 | (year == 2014 & qtr > 4))) %>%
  filter(!is.na(ur_1w), !is.na(ur_4w))

# ì§€ì—­ë³„ íšŒê·€ ì¶”ì •
bridge_params <- bridge_train %>%
  group_by(region) %>%
  do({
    fit <- lm(ur_4w ~ ur_1w, data = .)
    tibble(a = coef(fit)[1], b = coef(fit)[2])
  }) %>%
  ungroup()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 4ï¸âƒ£ 4ì£¼ ê¸°ì¤€ ì™„ì „ ì‹œê³„ì—´ ìƒì„±
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
unemp_full <- unemp_1w %>%
  full_join(unemp_4w, by = c("region", "year", "qtr"), suffix = c("_1w", "_4w")) %>%
  left_join(bridge_params, by = "region") %>%
  mutate(
    # 4w ë°ì´í„° ìƒì„± ê·œì¹™
    ur_final = case_when(
      # â‘  1999.2/4 ì´ì „: 4w ê²°ì¸¡ â†’ íšŒê·€ ì˜ˆì¸¡
      year < 1999 | (year == 1999 & qtr < 3) ~ a + b * ur_1w,
      # â‘¡ 1999.3/4 ì´í›„: 4w ì‹¤ì¸¡ ìˆìœ¼ë©´ ê·¸ëŒ€ë¡œ ì‚¬ìš©
      !is.na(ur_4w) ~ ur_4w,
      # â‘¢ 4w ê²°ì¸¡ì´ì§€ë§Œ 1wëŠ” ì¡´ì¬í•˜ëŠ” ê²½ìš° (ì˜ˆì™¸ì )
      is.na(ur_4w) & !is.na(ur_1w) ~ a + b * ur_1w,
      TRUE ~ NA_real_
    ),
    source = case_when(
      year < 1999 | (year == 1999 & qtr < 3) ~ "predicted_from_1w",
      !is.na(ur_4w) ~ "actual_4w",
      is.na(ur_4w) & !is.na(ur_1w) ~ "bridged_after_2014",
      TRUE ~ "missing"
    )
  ) %>%
  arrange(region, year, qtr) %>%
  ungroup()

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5ï¸âƒ£ ì—°í‰ê·  ê³„ì‚° (ë‹¨ìˆœí‰ê· )
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
unemp_annual <- unemp_full %>%
  group_by(region, year) %>%
  summarise(unemp_year = mean(ur_final, na.rm = TRUE), .groups = "drop")


# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 6ï¸âƒ£ ì—°í‰ê·  ê³„ì‚°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
unemp_annual <- unemp_full %>%
  group_by(region, year) %>%
  summarise(unemp_year = mean(ur_final, na.rm = TRUE), .groups = "drop")

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì§€ì—­ëª… ì˜ë¬¸ ë³€í™˜ ë§¤í•‘
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
cluster_map <- c(
  "ì„œìš¸íŠ¹ë³„ì‹œ" = "Seoul",
  "ê²½ê¸°ë„" = "Gyeonggi-do",
  "ì¸ì²œê´‘ì—­ì‹œ" = "Incheon",
  "ëŒ€ì „ê´‘ì—­ì‹œ" = "Daejeon",
  "ì¶©ì²­ë¶ë„" = "Chungcheongbuk-do",
  "ì¶©ì²­ë‚¨ë„" = "Chungcheongnam-do",
  "ê´‘ì£¼ê´‘ì—­ì‹œ" = "Gwangju",
  "ì „ë¼ë¶ë„" = "Jeollabuk-do",
  "ì „ë¶íŠ¹ë³„ìì¹˜ë„" = "Jeollabuk-do",
  "ì „ë¼ë‚¨ë„" = "Jeollanam-do",
  "ëŒ€êµ¬ê´‘ì—­ì‹œ" = "Daegu",
  "ê²½ìƒë¶ë„" = "Gyeongsangbuk-do",
  "ë¶€ì‚°ê´‘ì—­ì‹œ" = "Busan",
  "ê²½ìƒë‚¨ë„" = "Gyeongsangnam-do",
  "ê°•ì›ë„" = "Gangwon-do",
  "ê°•ì›íŠ¹ë³„ìì¹˜ë„" = "Gangwon-do",
  "ì œì£¼ë„" = "Jeju-do",
  "ì œì£¼íŠ¹ë³„ìì¹˜ë„" = "Jeju-do",
  "ìš¸ì‚°ê´‘ì—­ì‹œ" = "Ulsan",
  "ì„¸ì¢…íŠ¹ë³„ìì¹˜ì‹œ" = "Sejong-si",
  # í†µí•© ì§€ì—­ ì¶”ê°€
  # "ê²½ìƒë‚¨ë„_í†µí•©" = "Gyeongsangnam-do",
  "ì¶©ì²­ë‚¨ë„_í†µí•©" = "Chungcheongnam-do"
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# ì˜ë¬¸ ë³€í™˜ ë° ì €ì¥
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
unemp_annual_en <- unemp_annual %>%
  mutate(region_en = cluster_map[region]) %>%
  relocate(region_en, .after = region)

# ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
head(unemp_annual_en)

# íŒŒì¼ ì €ì¥
write_csv(unemp_annual_en, "unemp_annual_combined_2014on_en.csv", append = FALSE)



# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 2ï¸âƒ£ pe_numë³„ ì—°ë„ ë§¤í•‘
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
period_map <- tribble(
  ~pe_num, ~year4, ~year5,
  15, 1996, 1997,
  16, 2001, 2002,
  17, 2006, 2007,
  18, 2011, 2012,
  19, 2015, 2016,
  20, 2020, 2021,
  21, 2023, 2024
)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3ï¸âƒ£ ë§¤í•‘ ê¸°ë°˜ìœ¼ë¡œ unemp4, unemp5 ìƒì„±
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
unemp_wide <- period_map %>%
  left_join(
    unemp_annual_en %>% rename(cluster = region_en, unemp4 = unemp_year),
    by = c("year4" = "year")
  ) %>%
  left_join(
    unemp_annual_en %>% rename(cluster = region_en, unemp5 = unemp_year),
    by = c("year5" = "year", "cluster" = "cluster")
  ) %>%
  select(pe_num, cluster, unemp4, unemp5) %>%
  filter(!is.na(cluster))   # â† â˜… ì—¬ê¸°ì„œ NA ì§€ì—­ ì™„ì „ ì œê±°!

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 4ï¸âƒ£ ì§€ì—­ ìˆœì„œ ë§ì¶”ê¸°
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
region_order <- c(
  "Seoul", "Gyeonggi-do", "Incheon", "Daejeon",
  "Chungcheongbuk-do", "Chungcheongnam-do",
  "Gwangju", "Jeollabuk-do", "Jeollanam-do",
  "Daegu", "Gyeongsangbuk-do", "Busan",
  "Ulsan",                 # ğŸ”„ ìƒˆë¡œ ì¶”ê°€
  "Gyeongsangnam-do", "Gangwon-do", "Jeju-do"
)

unemp_wide <- unemp_wide %>%
  mutate(cluster = factor(cluster, levels = region_order)) %>%
  arrange(pe_num, cluster)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5ï¸âƒ£ ê²°ê³¼ ì €ì¥
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
write.csv(unemp_wide, "unemp_panel_by_pe.csv", row.names = FALSE)


